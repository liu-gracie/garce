<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Call Grace</title>
  <link rel="stylesheet" href="stylesheet.css" />
  <script defer src="script.js"></script>
</head>
<body>
  <div class="container chat-container" style="display: flex; flex-direction: column; gap: 20px; position: relative;">

    <!-- BACK button at the top -->
    <button class="back-button" onclick="window.location.href='index.html'">&#9664; BACK</button>
    <div class="chat-title" id="callTitle" style="text-align:center;">Say something to Grace...</div>

    <!-- Content area: video + prompt input side by side -->
    <div style="display: flex; flex-direction: row; gap: 20px; flex: 1;">

      <!-- 3/4: Grace video section -->
      <div style="flex: 3; display: flex; justify-content: center; align-items: center; padding-left: 10px;">
        <video
          id="graceVideo"
          src="https://www.w3schools.com/html/mov_bbb.mp4"
          autoplay
          muted
          loop
          style="width: 90%; max-height: 90%; object-fit: cover; border-radius: 20px; border: 5px solid black;"
        ></video>
      </div>

      <!-- 1/4: Prompt input section -->
      <div style="flex: 1; display: flex; flex-direction: column; justify-content: center; gap: 20px;">
        <textarea id="callPrompt" class="message-box" placeholder="Say something to Grace..."></textarea>
        <button class="start-button" onclick="handleCall()">Call</button>
      </div>
    </div>
  </div>

<script>
  function updateGreeting(selector) {
    const identity = localStorage.getItem('identity');
    const el = document.querySelector(selector);

    if (!el) return;

    if (identity === 'mother') {
      el.textContent = "Hi Mother, how are you?";
    } else if (identity === 'professor') {
      el.textContent = "How can I help you, Professor?";
    } else if (identity === 'friend') {
      el.textContent = "Hey what's up :)";
    } else {
      el.textContent = "Say something to Grace...";
    }
  }

  window.addEventListener('DOMContentLoaded', () => {
    updateGreeting('#callTitle');
  });

  function handleCall() {
    const message = document.getElementById('callPrompt').value.trim();
    if (!message) return alert("Please type something to say to Grace.");

    alert("Grace is thinking...");
    // Future: fetch('/api/call', { method: 'POST', body: JSON.stringify({ message }) })
  }
</script>

</body>
</html>